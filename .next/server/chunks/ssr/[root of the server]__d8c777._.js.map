{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///Users/himanshusingh/Downloads/client/src/components/AssetSearch.jsx"],"sourcesContent":["\"use client\";\nimport React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { FaPlus, FaMinus, FaSpinner } from \"react-icons/fa\";\nimport Cookies from \"js-cookie\";\n\nconst AssetSearch = ({ fetchAssets, closeModal }) => {\n  const [symbol, setSymbol] = useState(\"\");\n  const [quantity, setQuantity] = useState(1);\n  const [assetName, setAssetName] = useState(\"\");\n  const [assets, setAssets] = useState([]);\n  const [selectedAsset, setSelectedAsset] = useState(null);\n  const [loading, setLoading] = useState(false); // For asset search\n  const [addLoading, setAddLoading] = useState(false); // For adding to cart\n  const [searching, setSearching] = useState(false);\n  const token = Cookies.get(\"token\");\n\n  const API_URL = process.env.NEXT_PUBLIC_API_URL + \"/api/user/assets\";\n  const FINNHUB_API_KEY = process.env.NEXT_PUBLIC_FINNHUB_API_KEY;\n\n  const handleSearch = () => {\n    if (symbol.trim() === \"\") return;\n\n    setSearching(true);\n    setLoading(true);\n    axios\n      .get(\n        `https://finnhub.io/api/v1/search?q=${symbol}&token=${FINNHUB_API_KEY}`\n      )\n      .then((response) => {\n        setAssets(response.data.result);\n      })\n      .catch((error) => console.log(\"Error fetching assets:\", error))\n      .finally(() => {\n        setLoading(false);\n        setSearching(false);\n      });\n  };\n\n  const adjustQuantity = (action) => {\n    if (action === \"increase\") setQuantity((prev) => prev + 1);\n    else if (action === \"decrease\" && quantity > 1)\n      setQuantity((prev) => prev - 1);\n  };\n\n  const handleSelectAsset = (asset) => {\n    setSelectedAsset(asset);\n    setSymbol(asset.symbol);\n    setAssetName(asset.name || asset.description || asset.symbol);\n    setAssets([]);\n  };\n\n  const addToCart = async () => {\n    if (quantity > 0 && symbol && assetName) {\n      setAddLoading(true); // Start loading when adding to cart\n      try {\n        await axios.post(\n          API_URL,\n          { symbol, quantity, name: assetName },\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n        alert(`Added ${quantity} of ${symbol} (${assetName}) to cart!`);\n        fetchAssets(true);\n        closeModal();\n      } catch (error) {\n        alert(\"Failed to add asset to cart.\");\n        console.error(error);\n      } finally {\n        setAddLoading(false); // Stop loading after adding\n      }\n    } else {\n      alert(\"Please select a valid asset.\");\n    }\n  };\n\n  return (\n    <div className=\"p-6 bg-white rounded-xl shadow-md max-w-lg mx-auto\">\n      <div className=\"mb-4\">\n        <div className=\"flex items-center space-x-4\">\n          <input\n            type=\"text\"\n            placeholder=\"Enter symbol (e.g., AAPL)\"\n            value={symbol}\n            onChange={(e) => setSymbol(e.target.value)}\n            className=\"w-full px-5 py-3 text-lg border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500\"\n          />\n          <button\n            onClick={handleSearch}\n            className=\"bg-blue-600 text-white rounded-md p-3 hover:bg-blue-700 transition relative\"\n            disabled={searching || loading}\n          >\n            {searching || loading ? (\n              <FaSpinner className=\"animate-spin inset-0 m-auto\" size={18} />\n            ) : (\n              \"Search\"\n            )}\n          </button>\n        </div>\n      </div>\n\n      {assets.length > 0 && (\n        <div className=\"mt-3 max-h-64 overflow-y-auto border border-gray-300 rounded-md bg-white shadow-lg\">\n          {loading ? (\n            <div className=\"p-4 text-center text-gray-500\">Loading...</div>\n          ) : (\n            assets.map((asset) => (\n              <div\n                key={asset.symbol}\n                className=\"p-3 cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSelectAsset(asset)}\n              >\n                <div className=\"flex justify-between items-center\">\n                  <div className=\"font-semibold text-gray-800\">\n                    {asset.symbol}\n                  </div>\n                  <div className=\"text-sm text-gray-500\">\n                    {asset.name || asset.description}\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      )}\n\n      {selectedAsset && (\n        <>\n          <div className=\"mt-6\">\n            <h3 className=\"text-lg font-semibold text-gray-800\">\n              Adjust Quantity\n            </h3>\n            <div className=\"flex items-center mt-3 space-x-3\">\n              <button\n                onClick={() => adjustQuantity(\"decrease\")}\n                className=\"px-4 py-3 bg-gray-200 text-white rounded-md shadow-sm hover:bg-gray-300 transition\"\n                disabled={quantity <= 1}\n              >\n                <FaMinus size={16} />\n              </button>\n              <div className=\"text-lg font-semibold text-gray-800\">\n                {quantity}\n              </div>\n              <button\n                onClick={() => adjustQuantity(\"increase\")}\n                className=\"px-4 py-3 bg-gray-200 text-white rounded-md shadow-sm hover:bg-gray-300 transition\"\n              >\n                <FaPlus size={16} />\n              </button>\n            </div>\n          </div>\n\n          <div className=\"mt-6 flex gap-4\">\n            <button\n              onClick={addToCart}\n              className=\"w-full py-3 bg-green-600 text-white rounded-md shadow-lg hover:bg-green-700 transition relative\"\n              disabled={addLoading}\n            >\n              {addLoading ? (\n                <FaSpinner\n                  className=\"animate-spin absolute inset-0 m-auto\"\n                  size={18}\n                />\n              ) : (\n                \"Add to Cart\"\n              )}\n            </button>\n            <button\n              onClick={closeModal}\n              className=\"w-full py-3 bg-gray-600 text-white rounded-md shadow-lg hover:bg-gray-700 transition\"\n            >\n              Close\n            </button>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default AssetSearch;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 374, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 420, "column": 0}, "map": {"version":3,"sources":["file:///Users/himanshusingh/Downloads/client/src/components/PortFolio.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\nimport io from \"socket.io-client\";\nimport { useRouter } from \"next/navigation\";\n\nconst AssetList = () => {\n  const token = Cookies.get(\"token\");\n  const [assets, setAssets] = useState([]);\n  const [totalValue, setTotalValue] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const router = useRouter();\n\n  const API_URL = `${process.env.NEXT_PUBLIC_API_URL}/api/user/assets`;\n\n  useEffect(() => {\n    const fetchAssets = async () => {\n      try {\n        const response = await axios.get(API_URL, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        });\n        setAssets(response.data.assets);\n      } catch (err) {\n        console.error(err);\n        setError(\"Failed to fetch assets. Please try again later.\");\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAssets();\n  }, [token]);\n\n  useEffect(() => {\n    const total = assets.reduce((total, userAsset) => {\n      return total + userAsset.quantity * userAsset.assetId.currentPrice;\n    }, 0);\n    setTotalValue(total);\n  }, [assets]);\n\n  useEffect(() => {\n    const socket = io(process.env.NEXT_PUBLIC_SOCKET_URL);\n    assets.forEach((userAsset) => {\n      socket.emit(\"join-room\", userAsset.assetId.symbol);\n    });\n\n    socket.on(\"portfolio-update\", (data) => {\n      setAssets((prevAssets) =>\n        prevAssets.map((asset) =>\n          asset.assetId.symbol === data.asset\n            ? {\n                ...asset,\n                assetId: {\n                  ...asset.assetId,\n                  currentPrice: data.newPrice,\n                },\n              }\n            : asset\n        )\n      );\n    });\n\n    return () => {\n      socket.disconnect();\n    };\n  }, [assets]);\n\n  const handleViewDetails = (symbol) => {\n    router.push(`/user/stock-details/${symbol}`);\n  };\n\n  if (loading) {\n    return <div className=\"text-center text-blue-500 mt-8\">Loading...</div>;\n  }\n\n  if (error) {\n    return <div className=\"text-center text-red-500 mt-8\">{error}</div>;\n  }\n\n  return (\n    <div className=\"mx-auto p-6\">\n      <h2 className=\"text-3xl font-semibold text-gray-800 mb-6 text-center\">\n        Your Portfolio\n      </h2>\n      <div className=\"bg-white shadow-lg rounded-lg p-6\">\n        <div className=\"mb-6\">\n          <h3 className=\"text-2xl font-bold text-gray-700\">\n            Total Value: <span className=\"text-green-600\">${totalValue}</span>\n          </h3>\n        </div>\n\n        <div className=\"space-y-4\">\n          {assets.map((userAsset) => (\n            <div\n              key={userAsset.assetId._id}\n              className=\"flex justify-between items-center bg-gray-100 p-4 rounded-lg shadow-sm\"\n            >\n              <div>\n                <h4 className=\"font-semibold text-lg text-gray-800\">\n                  {userAsset.assetId.name} ({userAsset.assetId.symbol})\n                </h4>\n                <p className=\"text-sm text-gray-600\">\n                  Quantity: {userAsset.quantity} | Current Price: $\n                  {userAsset.assetId.currentPrice}\n                </p>\n              </div>\n              <div>\n                <button\n                  onClick={() => handleViewDetails(userAsset.assetId.symbol)} // Call function on click\n                  className=\"px-6 py-2 bg-green-600 text-white rounded-lg shadow hover:bg-green-700 transition\"\n                >\n                  View Details\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AssetList;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 637, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}